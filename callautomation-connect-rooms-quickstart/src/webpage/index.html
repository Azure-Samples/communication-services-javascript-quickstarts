<!DOCTYPE html>
<html lang="en">

<head>
  <title>Azure Communication Services Quickstart</title>
</head>

<body>
  <h4>Azure Communication Services</h4>
  <h2>Connect Rooms Call Quickstart</h2>

  <form>
    <div>
      <input type="submit" formaction="/connectCall" value="Connect call!">
      <input type="submit" formaction="/addParticipant" value="Add participant!">
      <input type="submit" formaction="/playMedia" value="Play media!">
      <input type="submit" formaction="/hangup" value="Hangup call!">
    </div>

    <h3>Room Details</h3>

    <div id="roomId-info">
      <h4>Room</h4>
      <p>Room Id: <span id="roomId-text">Loading roomId...</span></p>
    </div>

    <div id="presenter-info">
      <h4>Presenter</h4>
      <p>User Id: <span id="presenter-id">Loading presenter userId...</span></p>
      <p>Token: <span id="presenter-token">Loading presenter token...</span></p>
    </div>

    <div id="attendee-info">
      <h4>Attendee</h4>
      <p>User Id: <span id="attendee-id">Loading attendee userId...</span></p>
      <p>Token: <span id="attendee-token">Loading attendee token...</span></p>
    </div>
  </form>

  <script>
    fetch('/room-data')
      .then(response => response.json())
      .then(data => {

        document.getElementById('roomId-text').innerText = `${data.roomId}`;

        document.getElementById('presenter-id').innerText = `${data.user1.user.communicationUserId}`;
        document.getElementById('presenter-token').innerText = `${data.user1.token}`;

        document.getElementById('attendee-id').innerText = `${data.user2.user.communicationUserId}`;
        document.getElementById('attendee-token').innerText = `${data.user2.token}`;
      })
      .catch(error => {
        console.error('Error fetching user data:', error);
      });
  </script>
</body>

</html>